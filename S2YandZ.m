function [Y,Z]= S2YandZ(S,Zo)

for i=1:size(S,3)
   Y(1,1,i)=(1/Zo)*((1-S(1,1,i))*(1+S(2,2,i))+S(1,2,i)*S(2,1,i))/((1+S(1,1,i))*(1+S(2,2,i))-S(1,2,i)*S(2,1,i));
   Y(1,2,i)=(1/Zo)*(-2*S(1,2,i))/((1+S(1,1,i))*(1+S(2,2,i))-S(1,2,i)*S(2,1,i));
   Y(2,1,i)=(1/Zo)*(-2*S(2,1,i))/((1+S(1,1,i))*(1+S(2,2,i))-S(1,2,i)*S(2,1,i));
   Y(2,2,i)=(1/Zo)*((1+S(1,1,i))*(1-S(2,2,i))+S(1,2,i)*S(2,1,i))/((1+S(1,1,i))*(1+S(2,2,i))-S(1,2,i)*S(2,1,i));
   YY=Y(1,1,i)*Y(2,2,i)-Y(2,1,i)*Y(1,2,i);
   Z=1;
%    if YY>1e-9
%        Z(1,1,i)=Y(2,2,i)/YY;
%        Z(1,2,i)=-Y(1,2,i)/YY;
%        Z(2,1,i)=-Y(2,1,i)/YY;
%        Z(2,2,i)=Y(1,1,i)/YY;
%    else
%        Z='no value';
%    end
end;